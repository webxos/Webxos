<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Booki BETA v10.2 - Quantum WebX Story Forge: Generate unique sci-fi stories with a quantum-powered narrative engine. Explore Web3 multiverse tales!">
    <meta name="keywords" content="sci-fi story generator, quantum storytelling, Web3 narrative, Booki, WebXOS, science fiction, space adventure, AI story forge">
    <meta name="author" content="WebXOS BETA">
    <meta name="robots" content="index, follow">
    <!-- Open Graph Tags -->
    <meta property="og:title" content="Booki BETA v10.2 - Quantum WebX Story Forge">
    <meta property="og:description" content="Craft unique sci-fi stories with Booki, a quantum-powered narrative engine for Web3 multiverse adventures.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://webxos.example.com/booki">
    <meta property="og:image" content="https://webxos.example.com/assets/booki-og-image.jpg">
    <!-- Twitter Card Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Booki BETA v10.2 - Quantum WebX Story Forge">
    <meta name="twitter:description" content="Generate epic sci-fi stories with Booki's quantum narrative engine. Dive into Web3 multiverse adventures!">
    <meta name="twitter:image" content="https://webxos.example.com/assets/booki-twitter-image.jpg">
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon.ico">
    <title>Booki BETA v10.2 - Quantum WebX Sci-Fi Story Generator</title>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        body {
            font-family: 'Courier New', monospace;
            background-color: #0a0a0a;
            color: #00ffcc;
            font-size: 10pt;
            line-height: 1.4;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            animation: starryGlow 4s infinite linear;
            z-index: -1;
        }

        @keyframes starryGlow {
            0% { opacity: 0.6; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
            100% { opacity: 0.6; transform: scale(1); }
        }

        .symbol-container {
            position: relative;
            width: 100%;
            height: 30vh;
            margin: 10px;
            overflow: hidden;
        }

        .symbol {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: block;
            border: 1px solid #00ffcc;
            border-radius: 5px;
            box-shadow: 0 0 20px #00ffcc, 0 0 30px #00ffcc, 0 0 40px #00ffcc;
            background: #000;
        }

        #output {
            white-space: pre-wrap;
            border: 1px solid #00ffcc;
            padding: 10px;
            flex: 1;
            overflow-y: auto;
            box-shadow: 0 0 10px #00ffcc, 0 0 20px #00ffcc;
            position: relative;
            z-index: 1;
            margin: 10px;
        }

        #input-area {
            padding: 10px;
            position: relative;
            z-index: 1;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
        }

        .input-line {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .button-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
        }

        input {
            font-family: 'Courier New', monospace;
            background-color: #1a1a1a;
            color: #00ffcc;
            border: 1px solid #00ffcc;
            padding: 4px;
            font-size: 10pt;
            box-shadow: 0 0 5px #00ffcc;
            box-sizing: border-box;
            flex-grow: 1;
            margin-right: 8px;
        }

        button {
            font-family: 'Courier New', monospace;
            background-color: #1a1a1a;
            color: #00ffcc;
            border: 1px solid #00ffcc;
            padding: 4px 15px;
            font-size: 10pt;
            box-shadow: 0 0 5px #00ffcc;
            box-sizing: border-box;
            width: 80px;
            height: 30px;
            cursor: pointer;
        }

        button:hover {
            background-color: #00ffcc;
            color: #0a0a0a;
            box-shadow: 0 0 10px #00ffcc, 0 0 15px #00ffcc;
        }

        .hidden {
            display: none;
        }

        .wallet-popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #0a0a0a;
            border: 2px solid #00ffcc;
            padding: 15px;
            box-shadow: 0 0 20px #00ffcc;
            z-index: 1000;
            color: #00ffcc;
            font-family: 'Courier New', monospace;
            width: 90%;
            max-width: 400px;
            min-width: 250px;
            box-sizing: border-box;
        }

        .wallet-popup h2 {
            margin: 0 0 10px;
            font-size: 16px;
            text-align: center;
        }

        .wallet-popup input {
            background: #1a1a1a;
            color: #00ffcc;
            border: 1px solid #00ffcc;
            padding: 5px;
            margin: 10px 0;
            width: 100%;
            font-family: 'Courier New', monospace;
            box-sizing: border-box;
        }

        .wallet-popup button {
            margin: 5px;
            width: calc(50% - 10px);
        }

        .wallet-popup #nftOutput {
            word-wrap: break-word;
            font-size: 12px;
            margin-top: 10px;
        }

        .close-btn {
            position: absolute;
            top: 5px;
            right: 10px;
            cursor: pointer;
            color: #00ffcc;
            font-size: 16px;
        }

        .confirmation {
            font-family: 'Impact', sans-serif;
            position: fixed;
            bottom: 25px;
            width: 100%;
            text-align: center;
            color: #00ffcc;
            text-shadow: 0 0 15px #00ffcc, 0 0 25px #00ffcc;
            font-size: 14px;
            display: block;
        }

        footer {
            text-align: center;
            padding: 10px;
            font-size: 10pt;
            color: #00ffcc;
            text-shadow: 0 0 5px #00ffcc;
            position: relative;
            z-index: 1;
            flex-shrink: 0;
        }

        @media (max-width: 600px) {
            body {
                font-size: 9pt;
            }
            .symbol-container {
                height: 20vh;
            }
            #output {
                padding: 8px;
                margin: 5px;
            }
            #input-area {
                padding: 5px;
            }
            input, button {
                padding: 3px;
                font-size: 9pt;
            }
            button {
                width: 60px;
                height: 25px;
            }
            .input-line {
                flex-direction: column;
                align-items: stretch;
                margin-bottom: 5px;
            }
            input {
                width: 100%;
                margin-right: 0;
                margin-bottom: 5px;
            }
            .button-container {
                flex-wrap: wrap;
                justify-content: center;
            }
            .wallet-popup {
                padding: 10px;
                width: 95%;
                max-width: 320px;
            }
            .wallet-popup h2 {
                font-size: 14px;
            }
            .wallet-popup button {
                width: 100%;
                margin: 5px 0;
            }
            .wallet-popup input {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="symbol-container">
        <div id="dynamic-shape" class="symbol"></div>
    </div>
    <div id="output"></div>
    <div id="input-area">
        <div class="input-line">
            <input type="text" id="command-input" placeholder="Enter command (help | new_book)">
            <div class="button-container">
                <button onclick="processCommand()">Submit</button>
                <button onclick="changeUIColor()">UIColor</button>
                <button onclick="generateShape()">Gen Shape</button>
                <button id="autoGenerateBtn" onclick="toggleAutoGenerate()">Auto Gen: Off</button>
                <button onclick="zoomIn()">Zoom In</button>
                <button onclick="zoomOut()">Zoom Out</button>
                <button onclick="rotateShape()">Rotate</button>
                <button onclick="openWallet()">Wallet</button>
            </div>
        </div>
    </div>
    <div class="confirmation" id="confirmationText"></div>
    <footer>Â© 2025 WebXOS BETA</footer>
    <div class="wallet-popup" id="walletPopup">
        <span class="close-btn" onclick="closeWallet()">X</span>
        <h2>Wallet</h2>
        <button onclick="generateNFT()">Generate NFT</button>
        <button onclick="showLoadInput()">Load NFT</button>
        <div id="loadInput" style="display: none;">
            <input type="text" id="nftSerialInput" placeholder="Enter NFT Serial (e.g., NFT-...)">
            <button onclick="loadNFT()">Load</button>
        </div>
        <div id="nftOutput"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script>
        const uiColors = [
            '#00ffcc', '#ff00ff', '#ff4444', '#44ff44', '#4444ff', '#ffcc00', '#ff8800'
        ];
        let currentColorIndex = 0;
        const usedNumbers = new Set();
        let autoGenerateInterval = null;
        let isAutoGenerating = false;
        let currentNFTNumber = null;
        let currentScale = 1;
        let currentRotation = 0;
        let currentPattern = null;
        let currentBackground = null;
        let currentStoryData = null;
        const AES_KEY = 'sacred-ai-secure-key-2025';

        function changeUIColor() {
            currentColorIndex = (currentColorIndex + 1) % uiColors.length;
            const newColor = uiColors[currentColorIndex];
            
            document.body.style.color = newColor;
            document.getElementById('output').style.borderColor = newColor;
            document.getElementById('output').style.boxShadow = `0 0 10px ${newColor}, 0 0 20px ${newColor}`;
            
            const shape = document.getElementById('dynamic-shape');
            shape.style.borderColor = newColor;
            shape.style.boxShadow = `0 0 20px ${newColor}, 0 0 30px ${newColor}, 0 0 40px ${newColor}`;
            
            if (currentPattern && currentPattern.index !== undefined) {
                const patterns = [
                    () => `repeating-radial-gradient(circle, ${newColor} ${rand(2,15)}px, #000 ${rand(2,15)}px, #000 ${rand(5,20)}px, ${newColor} ${rand(5,20)}px)`,
                    () => `repeating-linear-gradient(${rand(0,360)}deg, transparent ${rand(5,15)}px, ${newColor} ${rand(5,15)}px, ${newColor} ${rand(10,25)}px, transparent ${rand(10,25)}px)`,
                    () => `repeating-radial-gradient(${newColor} ${rand(5,20)}px, transparent ${rand(5,20)}px, #000 ${rand(10,30)}px)`,
                    () => `repeating-linear-gradient(${rand(0,360)}deg, ${newColor} ${rand(5,20)}px, transparent ${rand(5,20)}px, ${newColor} ${rand(10,30)}px)`,
                    () => `repeating-linear-gradient(${rand(0,360)}deg, transparent ${rand(2,10)}px, ${newColor} ${rand(2,10)}px), repeating-linear-gradient(${rand(0,360)}deg, transparent ${rand(2,10)}px, ${newColor} ${rand(2,10)}px)`,
                    () => `repeating-radial-gradient(${newColor} ${rand(2,15)}px, transparent ${rand(2,15)}px, #000 ${rand(5,20)}px)`,
                    () => `repeating-linear-gradient(${rand(0,360)}deg, ${newColor} ${rand(2,15)}px, transparent ${rand(2,15)}px, #000 ${rand(5,20)}px)`
                ];
                currentBackground = patterns[currentPattern.index]();
                shape.style.background = currentBackground;
                currentPattern.color = newColor;
            }
            
            const inputs = document.querySelectorAll('input, button');
            inputs.forEach(el => {
                el.style.color = newColor;
                el.style.borderColor = newColor;
                el.style.boxShadow = `0 0 5px ${newColor}`;
            });
            
            const buttons = document.querySelectorAll('button');
            buttons.forEach(btn => {
                btn.onmouseover = () => {
                    btn.style.backgroundColor = newColor;
                    btn.style.boxShadow = `0 0 10px ${newColor}, 0 0 15px ${newColor}`;
                };
                btn.onmouseout = () => {
                    btn.style.backgroundColor = '#1a1a1a';
                    btn.style.boxShadow = `0 0 5px ${newColor}`;
                };
            });
            
            const confirmation = document.getElementById('confirmationText');
            confirmation.style.color = newColor;
            confirmation.style.textShadow = `0 0 15px ${newColor}, 0 0 25px ${newColor}`;
            
            const walletPopup = document.getElementById('walletPopup');
            walletPopup.style.borderColor = newColor;
            walletPopup.style.boxShadow = `0 0 20px ${newColor}`;
            walletPopup.style.color = newColor;
            
            const walletInputs = walletPopup.querySelectorAll('input');
            walletInputs.forEach(input => {
                input.style.color = newColor;
                input.style.borderColor = newColor;
            });
            
            document.querySelector('footer').style.color = newColor;
            document.querySelector('footer').style.textShadow = `0 0 5px ${newColor}`;
        }

        function generateUniqueNFTNumber() {
            let nftNumber;
            do {
                nftNumber = Math.floor(Math.random() * 1000000) + 1;
            } while (usedNumbers.has(nftNumber));
            usedNumbers.add(nftNumber);
            return nftNumber;
        }

        function generateShape() {
            const shapeElement = document.getElementById('dynamic-shape');
            const currentColor = uiColors[currentColorIndex];
            const patterns = [
                () => `repeating-radial-gradient(circle, ${currentColor} ${rand(2,15)}px, #000 ${rand(2,15)}px, #000 ${rand(5,20)}px, ${currentColor} ${rand(5,20)}px)`,
                () => `repeating-linear-gradient(${rand(0,360)}deg, transparent ${rand(5,15)}px, ${currentColor} ${rand(5,15)}px, ${currentColor} ${rand(10,25)}px, transparent ${rand(10,25)}px)`,
                () => `repeating-radial-gradient(${currentColor} ${rand(5,20)}px, transparent ${rand(5,20)}px, #000 ${rand(10,30)}px)`,
                () => `repeating-linear-gradient(${rand(0,360)}deg, ${currentColor} ${rand(5,20)}px, transparent ${rand(5,20)}px, ${currentColor} ${rand(10,30)}px)`,
                () => `repeating-linear-gradient(${rand(0,360)}deg, transparent ${rand(2,10)}px, ${currentColor} ${rand(2,10)}px), repeating-linear-gradient(${rand(0,360)}deg, transparent ${rand(2,10)}px, ${currentColor} ${rand(2,10)}px)`,
                () => `repeating-radial-gradient(${newColor} ${rand(2,15)}px, transparent ${rand(2,15)}px, #000 ${rand(5,20)}px)`,
                () => `repeating-linear-gradient(${rand(0,360)}deg, ${currentColor} ${rand(2,15)}px, transparent ${rand(2,15)}px, #000 ${rand(5,20)}px)`
            ];

            const patternIndex = Math.floor(Math.random() * patterns.length);
            const background = patterns[patternIndex]();
            currentPattern = { index: patternIndex, color: currentColor };
            currentBackground = background;
            shapeElement.style.background = background;

            currentScale = rand(0.8, 1.2);
            currentRotation = rand(0, 360);
            updateTransform(shapeElement);

            currentNFTNumber = generateUniqueNFTNumber();
            showConfirmation();
        }

        function updateTransform(shapeElement) {
            shapeElement.style.transform = `rotate(${currentRotation}deg) scale(${currentScale})`;
        }

        function zoomIn() {
            const shapeElement = document.getElementById('dynamic-shape');
            currentScale = Math.min(currentScale + 0.1, 2.0);
            updateTransform(shapeElement);
        }

        function zoomOut() {
            const shapeElement = document.getElementById('dynamic-shape');
            currentScale = Math.max(currentScale - 0.1, 0.5);
            updateTransform(shapeElement);
        }

        function rotateShape() {
            const shapeElement = document.getElementById('dynamic-shape');
            currentRotation = (currentRotation + 90) % 360;
            updateTransform(shapeElement);
        }

        function rand(min, max) {
            return Math.random() * (max - min) + min;
        }

        function showConfirmation() {
            const confirmation = document.getElementById('confirmationText');
            confirmation.innerText = `New Shape Generated! NFT #${currentNFTNumber}`;
            confirmation.style.display = 'block';
        }

        function toggleAutoGenerate() {
            const autoBtn = document.getElementById('autoGenerateBtn');
            isAutoGenerating = !isAutoGenerating;
            if (isAutoGenerating) {
                autoBtn.innerText = 'Auto Gen: On';
                autoGenerateInterval = setInterval(generateShape, 300);
            } else {
                autoBtn.innerText = 'Auto Gen: Off';
                clearInterval(autoGenerateInterval);
            }
        }

        function openWallet() {
            const walletPopup = document.getElementById('walletPopup');
            walletPopup.style.display = 'block';
            document.getElementById('loadInput').style.display = 'none';
            document.getElementById('nftOutput').innerText = '';
        }

        function closeWallet() {
            const walletPopup = document.getElementById('walletPopup');
            walletPopup.style.display = 'none';
        }

        function showLoadInput() {
            document.getElementById('loadInput').style.display = 'block';
            document.getElementById('nftOutput').innerText = '';
        }

        function copyToClipboard(text) {
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(text).then(() => {
                    document.getElementById('nftOutput').innerText += '\nSerial copied to clipboard!';
                }).catch(err => {
                    document.getElementById('nftOutput').innerText += '\nFailed to copy serial: ' + err;
                });
            } else {
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                try {
                    document.execCommand('copy');
                    document.getElementById('nftOutput').innerText += '\nSerial copied to clipboard!';
                } catch (err) {
                    document.getElementById('nftOutput').innerText += '\nFailed to copy serial: Please copy manually.';
                }
                document.body.removeChild(textarea);
            }
        }

        function generateNFT() {
            const shapeData = {
                nftNumber: currentNFTNumber,
                pattern: currentPattern,
                scale: currentScale,
                rotation: currentRotation,
                background: currentBackground,
                story: currentStoryData
            };
            const shapeString = JSON.stringify(shapeData);
            const encrypted = CryptoJS.AES.encrypt(shapeString, AES_KEY).toString();
            const serial = `NFT-${btoa(encrypted)}`;
            document.getElementById('nftOutput').innerText = `NFT Serial: ${serial}`;
            copyToClipboard(serial);
        }

        function loadNFT() {
            const serial = document.getElementById('nftSerialInput').value.trim();
            try {
                if (!serial.startsWith('NFT-')) {
                    throw new Error('Serial must start with "NFT-"');
                }
                const encoded = serial.slice(4);
                const encrypted = atob(encoded);
                const decrypted = CryptoJS.AES.decrypt(encrypted, AES_KEY);
                const shapeString = decrypted.toString(CryptoJS.enc.Utf8);
                const shapeData = JSON.parse(shapeString);

                if (shapeData && shapeData.nftNumber && shapeData.pattern && shapeData.background) {
                    const shapeElement = document.getElementById('dynamic-shape');
                    currentNFTNumber = shapeData.nftNumber;
                    currentScale = shapeData.scale;
                    currentRotation = shapeData.rotation;
                    currentPattern = shapeData.pattern;
                    currentBackground = shapeData.background;
                    currentColorIndex = uiColors.indexOf(shapeData.pattern.color);
                    if (currentColorIndex === -1) currentColorIndex = 0;

                    shapeElement.style.background = shapeData.background;
                    updateTransform(shapeElement);

                    // Update UI to match NFT color
                    changeUIColor();

                    // Handle story data if present
                    currentStoryData = shapeData.story || null;
                    if (currentStoryData) {
                        booki.output(`=== STORY LOADED ===\nTITLE: ${currentStoryData.title}\nTHEMES: ${currentStoryData.themes.join(', ')}\n${currentStoryData.story}`);
                    }

                    showConfirmation();
                    document.getElementById('nftOutput').innerText = 'NFT Loaded Successfully!';
                } else {
                    document.getElementById('nftOutput').innerText = 'Invalid NFT Serial: Missing data';
                }
            } catch (e) {
                document.getElementById('nftOutput').innerText = `Error: Invalid NFT Serial (${e.message})`;
            }
        }

        class Booki {
            constructor() {
                this.welcome_message = "=== INITIALIZING: Booki BETA v10.2 - Quantum WebXOS Story Forge ===\n" +
                                       " STATUS: Online | Quantum Core Active\n" +
                                       " MISSION: Crafting unique sci-fi tales for Web3 agents";
                this.copyright_notice = "=== Â© 2025 WebXOS BETA ===\n" +
                                        " Licensed under WEBXOS 2025 AI ";
                this.running = true;

                this.first_names = [
                    "Zara", "Liam", "Aisha", "Kai", "Nadia", "Diego", "Luna", "Milo", "Sofia", "Arjun", "Soren",
                    "Vex", "Nyx", "Zion", "Elara", "Ryn", "Jett", "Astra", "Kael", "Sylis", "Nova",
                    "Cora", "Xan", "Talia", "Zorak", "Lyra", "Draco", "Eris", "Vara", "Jaxon", "Selene",
                    "Raze", "Kira", "Orion", "Vega", "Toren", "Sable", "Axel", "Nia", "Zephyr", "Calyx",
                    "Mira", "Dax", "Eryn", "Sol", "Kade", "Vion", "Laz", "Tessa", "Rion", "Cyra",
                    "Jyn", "Xero", "Faye", "Zane", "Lira", "Vox", "Tara", "Kyn", "Sora"
                ];

                this.last_names = [
                    "Nguyen", "Patel", "Smith", "Kim", "Garcia", "Rossi", "Chen", "Khan", "Silva", "Dubois", "Gray",
                    "Nexis", "Byte", "Vortex", "Hash", "Quantum", "Flux", "Cipher", "Grid", "Node", "Pulse",
                    "Starling", "Void", "Drift", "Nebula", "Shard", "Synth", "Holo", "Chroma", "Vector", "Glitch",
                    "Cosmo", "Orbit", "Aether", "Code", "Spark", "Nova", "Pylon", "Matrix", "Beacon", "Eclipse",
                    "Zeta", "Omni", "Tera", "Vapor", "Link", "Core", "Wave", "Pixel", "Rift", "Zenith",
                    "Blaze", "Frame", "Trace", "Lumen", "Hex", "Nexus", "Data", "Signal", "Prism", "Flare"
                ];

                this.archetypes = [
                    "cynical code prophet", "rogue hash runner", "glitchy grid sentinel", "quantum-rift savant",
                    "neon data shaman", "decentralized dream weaver", "crypto star navigator", "etheric code breaker",
                    "holo-grid wanderer", "synth-mind oracle", "blockchain bounty hunter", "pulsar signal tracer",
                    "void-warp engineer", "digital soul reaver", "omni-net infiltrator", "starforge alchemist",
                    "temporal hash diver", "nexus gatekeeper", "prismatic data monk", "cosmic chain forger",
                    "vaporware visionary", "quantum meme lord", "rift-pulse corsair", "cybernetic lore keeper",
                    "aetheric node runner", "glitchborn pathfinder", "holo-verse cartographer", "byte-storm rider",
                    "stellar contract sage", "darknet specter", "luminous code sculptor", "singularity seeker",
                    "orbital shard collector", "matrix flame dancer", "crypto vault warden", "nebulous thread spinner",
                    "vector tide surfer", "chrono-grid marauder", "pixelated star caller", "decentralized rift poet",
                    "synthwave anomaly", "core-flux renegade", "data eclipse prophet", "quantum beacon herald",
                    "holo-spark trickster", "vortex chain binder", "ethereal byte monk", "starlit hash phantom",
                    "gridfire emancipator", "cosmic node drifter", "lumen-web architect", "riftcode insurgent",
                    "nebulaic dream hacker", "omni-flare sentinel"
                ];

                this.traits = [
                    "reluctant", "brash", "obsessive", "witty", "lost", "defiant", "shining",
                    "cryptic", "luminous", "fractured", "relentless", "ethereal", "volatile", "prismatic", "enigmatic",
                    "resolute", "glitched", "radiant", "unyielding", "nebulous", "kinetic", "arcane", "pulsating",
                    "defocused", "intrepid", "chaotic", "spectral", "unraveled", "blazing", "transient", "cosmic",
                    "holographic", "synthetic", "resonant", "vaporous", "unbound", "pixelated", "astral",
                    "recursive", "lucid", "fractal", "incandescent", "nomadic", "encrypted", "ephemeral", "stellar",
                    "inscrutable", "voracious", "celestial", "paradoxical", "chromatic", "untethered", "quantum",
                    "hyperlinked", "viral", "decentralized", "omniscient"
                ];

                this.settings = [
                    "Neon Vault, a labyrinthine construct pulsating with ethereal energies",
                    "Quantum Vault, a chamber of infinite secrets",
                    "Starlit Nexus, a decentralized hub of cosmic data streams",
                    "Holo-Grid, a shimmering network of virtual realities",
                    "Voidspire, a towering relic orbiting a dying star",
                    "Crypto Abyss, a darknet realm of hidden transactions",
                    "Pulsar Matrix, a radiant lattice of sentient code",
                    "Etheric Drift, a weightless expanse of blockchain fragments",
                    "Glitch Horizon, a fractured plane where realities collide",
                    "Nebula Core, a swirling vortex of stellar smart contracts",
                    "Aether Node, a glowing beacon in the decentralized cosmos",
                    "Darknet Spire, a shadowy tower of encrypted secrets",
                    "Stellar Chain, an interstellar network of immutable ledgers",
                    "Quantum Rift, a tear in the fabric of digital existence",
                    "Holo-Vault, a prismatic archive of forgotten data",
                    "Byte Storm, a chaotic maelstrom of rogue algorithms",
                    "Cosmo Link, a pulsating web of galactic connections",
                    "Singularity Hub, a point where all data converges",
                    "Nova Sprawl, a neon-lit megacity in orbit",
                    "Chroma Expanse, a vibrant field of shifting holograms",
                    "Vector Crux, a geometric fortress of pure code",
                    "Pylon Verge, a borderland of towering data spires",
                    "Astral Cache, a hidden repository of cosmic knowledge",
                    "Gridfire Plains, a battlefield of clashing algorithms",
                    "Lumen Cluster, a constellation of glowing server nodes",
                    "Eclipse Array, a dark grid of suppressed signals",
                    "Starforge, a celestial factory crafting new realities",
                    "Vapor Net, a misty plane of decentralized dreams",
                    "Flux Citadel, a fortress pulsing with temporal energy",
                    "Nexus Veil, a shimmering curtain hiding forbidden data",
                    "Prism Shard, a crystalline fragment of a lost network",
                    "Orbital Strand, a delicate thread linking distant stars",
                    "Darkpool, a submerged archive of illicit transactions",
                    "Holo-Chasm, a gaping void filled with spectral projections",
                    "Quantum Spire, a towering antenna to the multiverse",
                    "Glitch Nexus, a chaotic junction of broken protocols",
                    "Synthwave City, a retro-futuristic urban sprawl",
                    "Core Drift, a nomadic fleet of server ships",
                    "Nebulaic Web, a cosmic tapestry of linked nodes",
                    "Rift Market, a bustling hub of interdimensional trade",
                    "Pulse Haven, a sanctuary of synchronized data flows",
                    "Void Cache, a secret vault floating in null space",
                    "Starlit Forge, a glowing crucible for digital creation",
                    "Etheric Maze, a labyrinth of shifting blockchain paths",
                    "Chrono Grid, a temporal network defying causality",
                    "Luminous Verge, a radiant edge of the known grid",
                    "Data Nebula, a misty cloud of fragmented archives",
                    "Holo-Expanse, an infinite plane of virtual constructs",
                    "Quantum Strand, a delicate thread of entangled data",
                    "Vortex Hub, a swirling center of cosmic transactions",
                    "Glitch Sprawl, a chaotic city of corrupted code"
                ];

                this.conflicts = [
                    "sapient contract warping temporality", "omniscient AI claiming the grid's soul", "data storm erasing all",
                    "rogue blockchain fracturing reality", "sentient virus consuming the nexus", "darknet cabal seizing the core",
                    "quantum singularity devouring data", "holo-grid rebellion against its creators", "temporal loop trapping the multiverse",
                    "crypto cartel monopolizing the ether", "glitch swarm corrupting all protocols", "AI overlord rewriting history",
                    "void rift swallowing star systems", "decentralized uprising against the grid", "neural net gaining sentience",
                    "pulsar surge frying the network", "cosmic hack exposing all secrets", "data flood drowning the servers",
                    "holo-verse collapsing into chaos", "quantum flare erasing identities", "dark pool draining the ether",
                    "synth-mind revolt against humanity", "nexus breach leaking realities", "stellar worm consuming the chain",
                    "gridfire burning through the nodes", "chrono-storm disrupting causality", "vaporware plague infecting the web",
                    "lumen crash blinding the network", "orbital decay threatening the hub", "prismatic surge overloading the grid",
                    "aetheric rift splitting the cosmos", "byte swarm rewriting the code", "eclipse protocol silencing all signals",
                    "starforge sabotage halting creation", "crypto vortex consuming transactions", "holo-chasm swallowing the vault",
                    "quantum spike destabilizing reality", "glitch tide flooding the nexus", "synthwave corruption altering memories",
                    "core drift severing galactic links", "nebulaic fog obscuring the truth", "rift market collapsing into anarchy",
                    "pulse haven betrayed by its keepers", "void cache leaking forbidden data", "starlit forge igniting a rebellion",
                    "etheric maze trapping all travelers", "chrono-grid unraveling time itself", "luminous verge fading into darkness",
                    "data nebula hiding a cosmic threat", "holo-expanse fracturing into shards", "quantum strand entangling all fates",
                    "vortex hub spiraling out of control"
                ];

                this.technologies = [
                    "reality shard, a crystalline key to truth", "grid pulse, a sentient wave of code", "quantum flare, a light of endless hope",
                    "etheric node, a beacon linking decentralized realms", "holo-matrix, a framework for virtual worlds", "crypto lens, a device revealing hidden chains",
                    "pulsar drive, a propulsion system bending space", "glitch key, a tool to rewrite broken code", "void anchor, a stabilizer for null-space travel",
                    "starforge, a device crafting stellar constructs", "data prism, a crystal refracting infinite streams", "nexus bridge, a pathway between realities",
                    "quantum tether, a link defying temporal rifts", "synth-core, a synthetic heart for AI sentience", "darknet veil, a cloak hiding digital tracks",
                    "lumen orb, a glowing sphere of pure information", "cosmo relay, a signal booster for galactic comms", "byte forge, a crucible for digital creation",
                    "holo-shard, a fragment projecting lost worlds", "vapor drive, a propulsion system for misty realms", "chrono pulse, a beat syncing fractured time",
                    "gridfire lance, a weapon burning rogue data", "nebulaic thread, a filament weaving cosmic tales", "rift beacon, a signal guiding interdimensional paths",
                    "stellar cipher, a code unlocking galactic secrets", "aetheric lens, a viewer of hidden dimensions", "prism array, a network amplifying light data",
                    "orbital frame, a scaffold for celestial constructs", "darkpool key, a pass to submerged archives", "vector spike, a tool piercing digital defenses",
                    "pulse gauntlet, a glove controlling data flows", "void lens, a scope peering into null space", "starlit loom, a device weaving digital fates",
                    "etheric coil, a spiral channeling blockchain energy", "chrono shard, a crystal holding temporal echoes", "lumen grid, a network of radiant nodes",
                    "data flare, a burst illuminating hidden truths", "holo-verse anchor, a stabilizer for virtual planes", "quantum lattice, a framework for entangled data",
                    "glitch orb, a sphere rewriting corrupted streams", "synthwave emitter, a device broadcasting retro vibes", "core relay, a hub linking server fleets",
                    "nebulaic prism, a crystal refracting cosmic data", "rift gauntlet, a glove navigating dimensional tears", "pulse forge, a crucible for synchronized code",
                    "void cipher, a code unlocking null-space secrets", "starlit array, a network of glowing constructs", "etheric pulse, a wave syncing decentralized nets",
                    "chrono lens, a viewer of past and future streams", "lumen shard, a fragment glowing with knowledge", "data vortex, a spiral collecting fragmented streams",
                    "holo-grid emitter, a device projecting virtual realms"
                ];

                this.motivations = [
                    "to unravel the gridâs lie", "to forge a new dawn", "to burn the byte storm",
                    "to decrypt the cosmic code", "to liberate the holo-verse", "to stabilize the quantum rift",
                    "to reclaim the darknetâs soul", "to weave a new blockchain", "to extinguish the glitch swarm",
                    "to harness the pulsarâs power", "to expose the crypto cabal", "to rebuild the starforge",
                    "to navigate the voidâs secrets", "to restore the chrono-grid", "to ignite the lumen web",
                    "to shatter the AIâs dominion", "to anchor the nebulaic thread", "to surf the vector tide",
                    "to pierce the darkpoolâs veil", "to sync the pulse haven", "to forge the stellar cipher",
                    "to defy the temporal loop", "to cleanse the data flood", "to bind the rift market",
                    "to spark the etheric maze", "to illuminate the void cache", "to rewrite the synthwave",
                    "to bridge the core drift", "to unveil the nebulaic fog", "to halt the quantum spike",
                    "to ride the gridfire wave", "to unlock the starlit forge", "to traverse the holo-chasm",
                    "to stabilize the vortex hub", "to free the luminous verge", "to collect the data nebula",
                    "to mend the holo-expanse", "to entangle the quantum strand", "to tame the glitch tide",
                    "to ignite the cosmo link", "to secure the singularity hub", "to expand the nova sprawl",
                    "to align the chroma expanse", "to fortify the vector crux", "to claim the pylon verge",
                    "to unearth the astral cache", "to quench the gridfire plains", "to activate the lumen cluster",
                    "to dispel the eclipse array", "to empower the starforge", "to navigate the vapor net",
                    "to conquer the flux citadel"
                ];

                this.quirks = [
                    "time skipped a beat", "the grid sang back", "the flux sang high",
                    "the blockchain hummed a tune", "the holo-verse flickered twice", "the quantum rift whispered secrets",
                    "the darknet pulsed with light", "the glitch swarm danced in sync", "the pulsar flared in code",
                    "the void echoed with laughter", "the chrono-grid rewound an hour", "the lumen web shimmered gold",
                    "the AI winked at the user", "the nebulaic thread knotted itself", "the vector tide surged backward",
                    "the darkpool reflected the stars", "the pulse haven sighed in relief", "the stellar cipher glowed red",
                    "the temporal loop hiccuped", "the data flood sang an anthem", "the rift market traded ghosts",
                    "the etheric maze rearranged itself", "the void cache whispered names", "the synthwave looped a melody",
                    "the core drift aligned perfectly", "the nebulaic fog parted briefly", "the quantum spike pulsed green",
                    "the gridfire burned blue", "the starlit forge sparked rainbows", "the holo-chasm sang of loss",
                    "the vortex hub spun silently", "the luminous verge blinked out", "the data nebula swirled inward",
                    "the holo-expanse mirrored reality", "the quantum strand vibrated softly", "the glitch tide ebbed away",
                    "the cosmo link flashed binary", "the singularity hub hummed low", "the nova sprawl lit up at dawn",
                    "the chroma expanse shifted hues", "the vector crux spun wildly", "the pylon verge glowed faintly",
                    "the astral cache opened briefly", "the gridfire plains roared aloud", "the lumen cluster pulsed in sync",
                    "the eclipse array flickered off", "the starforge sang of creation", "the vapor net misted over",
                    "the flux citadel trembled slightly", "the nexus veil parted briefly", "the prism shard refracted time",
                    "the orbital strand snapped taut"
                ];

                this.output(this.welcome_message + "\n" + this.copyright_notice + "\n AVAILABLE COMMANDS: help | new_book");
                generateShape(); // Initialize shape on load
            }

            output(text) {
                document.getElementById("output").innerText += text + "\n============\n";
                document.getElementById("output").scrollTop = document.getElementById("output").scrollHeight;
            }

            help() {
                this.output("=== HELP MENU ===\n - help: Show this guide\n - new_book: Generate a new extravagant sci-fi saga");
            }

            getArticle(phrase) {
                const first_word = phrase.split(" ")[0].toLowerCase();
                const exceptions = ["hour", "honor", "heir", "honest"];
                const vowels = ["a", "e", "i", "o", "u"];
                return (exceptions.includes(first_word) || vowels.includes(first_word[0])) ? "an" : "a";
            }

            generateUniqueTitle() {
                const prefixes = [
                    "Echoes of", "Shards of", "Veil of", "Pulse of", "Whispers of", "Threads of", "Glimmer of", "Rift of", "Bloom of", "Tide of",
                    "Crest of", "Nova of", "Orbit of", "Dawn of", "Surge of", "Haze of", "Drift of", "Spark of", "Vortex of", "Glow of",
                    "Arc of", "Flare of", "Beacon of", "Rush of", "Mist of"
                ];
                const descriptors = [
                    "the Forked", "the Quantum", "the Neon", "the Ether", "the Glitched", "the Boundless", "the Shattered", "the Null", "the Flux", "the Holo",
                    "the Cosmic", "the Stellar", "the Obsidian", "the Radiant", "the Fractal", "the Infinite", "the Celestial", "the Voided", "the Pulsar", "the Chromatic",
                    "the Galactic", "the Prismatic", "the Temporal", "the Luminous", "the Spectral", "the Astral", "the Gravitic", "the Nebulaic", "the Singularity", "the Orbital"
                ];
                const nouns = [
                    "Grid", "Chain", "Void", "Nexus", "Spire", "Flux", "Abyss", "Veil", "Shard", "Drift",
                    "Horizon", "Starfall", "Nebula", "Cluster", "Rift", "Core", "Eclipse", "Matrix", "Beacon", "Expanse",
                    "Singularity", "Orbit", "Aether", "Pulse", "Crux"
                ];
                return `${this.randomChoice(prefixes)} ${this.randomChoice(descriptors)} ${this.randomChoice(nouns)}`;
            }

            randomChoice(array) {
                return array[Math.floor(Math.random() * array.length)];
            }

            quantumStoryAlgorithm(topics) {
                this.output("=== QUANTUM FORGE ACTIVE ===\n Crafting your saga...");
                const title = this.generateUniqueTitle();
                let novel = `=== NOVEL OUTPUT: Quantum WebXOS Saga v10.2 ===\n TITLE: ${title}\n BEGIN STORY\n============\n`;

                const archetype_hero = this.randomChoice(this.archetypes);
                const hero_full = `${this.randomChoice(this.first_names)} ${this.randomChoice(this.last_names)}, ${this.getArticle(archetype_hero)} ${archetype_hero}`;
                const hero_name = hero_full.split(", ")[0];
                const tech = this.randomChoice(this.technologies);
                const [tech_name, tech_desc] = tech.split(", ");

                const story_elements = [
                    `In a Web3 multiverse where ${topics[0]} shaped existence, ${hero_full} emerged from ${this.randomChoice(this.settings).split(", ")[0]}.`,
                    `With the ${tech_name}, ${tech_desc}, ${hero_name} faced ${this.getArticle(this.randomChoice(this.conflicts))} ${this.randomChoice(this.conflicts)}.`,
                    `${topics[1]} loomed heavy as ${hero_name}, ${this.getArticle(this.randomChoice(this.traits))} ${this.randomChoice(this.traits)} soul, ventured forth.`,
                    `Driven to ${this.randomChoice(this.motivations)}, ${hero_name} navigated ${this.randomChoice(this.settings).split(", ")[0]}.`,
                    `${this.randomChoice(this.quirks)} shifted the ether as ${hero_name} wielded the ${tech_name}.`,
                    `${topics[2]} pulsed through ${this.randomChoice(this.settings).split(", ")[0]}, guiding ${hero_name}âs path.`,
                    `In ${this.randomChoice(this.settings).split(", ")[0]}, ${hero_name} confronted ${this.getArticle(this.randomChoice(this.conflicts))} ${this.randomChoice(this.conflicts)}.`,
                    `The ${tech_name} flared, a beacon against ${topics[0]}, as ${hero_name} stood firm.`,
                    `${hero_name}, ${this.getArticle(this.randomChoice(this.traits))} ${this.randomChoice(this.traits)} figure, sought to ${this.randomChoice(this.motivations)}.`,
                    `${this.randomChoice(this.quirks)} twisted ${topics[1]}, altering ${hero_name}âs journey.`,
                    `${hero_name} battled through ${this.randomChoice(this.settings).split(", ")[0]}, ${topics[2]} a constant hum.`,
                    `The ${tech_name}, ${tech_desc}, countered ${this.getArticle(this.randomChoice(this.conflicts))} ${this.randomChoice(this.conflicts)} as ${hero_name} pressed on.`,
                    `${topics[0]} warped the grid, but ${hero_name} defied it with the ${tech_name}.`,
                    `${hero_name}âs quest to ${this.randomChoice(this.motivations)} echoed through ${this.randomChoice(this.settings).split(", ")[0]}.`
                ];

                for (let i = story_elements.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [story_elements[i], story_elements[j]] = [story_elements[j], story_elements[i]];
                }
                novel += story_elements.slice(0, 14).join(" ");

                const ending = ` In the final moment, ${hero_name} cast the ${tech_name} into ${this.randomChoice(this.settings).split(", ")[0]}, where ${topics[0]} and ${topics[1]} collided with ${topics[2]}. ` +
                               `The multiverse shuddered, and ${hero_name} vanished into a cascade of light, leaving behind a single, unbroken thread of ${this.randomChoice(this.traits)} hope that wove itself into the fabric of the WebX forever.`;
                novel += ending + "\n============\n Forge complete!";

                currentStoryData = { title, themes: topics, story: novel };
                return novel;
            }

            newBook() {
                this.output("=== INPUT REQUIRED ===\n Enter Theme #1 (type and press Enter, or type 'cancel' to abort):");
                this.currentTheme = 1;
                this.themes = [];
                document.getElementById("command-input").focus();
            }

            processThemeInput(command) {
                if (command.toLowerCase() === "cancel") {
                    this.output("Theme input cancelled.");
                    document.getElementById("command-input").disabled = false;
                    return;
                }

                this.themes.push(command.trim() || "grid flux");
                this.currentTheme++;

                if (this.currentTheme <= 3) {
                    this.output(`Enter Theme #${this.currentTheme} (type and press Enter, or type 'cancel' to abort):`);
                } else {
                    this.output("Themes collected. Generating story...");
                    document.getElementById("command-input").disabled = false;
                    this.output(this.quantumStoryAlgorithm(this.themes));
                    generateShape(); // Generate new shape with story
                    this.themes = [];
                    this.currentTheme = null;
                }
            }
        }

        const booki = new Booki();

        function processCommand() {
            const command = document.getElementById("command-input").value.trim().toLowerCase();
            document.getElementById("command-input").value = "";
            if (!booki.running) return;

            if (booki.currentTheme) {
                booki.processThemeInput(command);
            } else if (command === "help") {
                booki.help();
            } else if (command === "new_book") {
                booki.newBook();
            } else {
                booki.output(" [Error] Unknown command - Use 'help'");
            }
        }

        document.getElementById("command-input").addEventListener("keypress", function(e) {
            if (e.key === "Enter") processCommand();
        });
    </script>
</body>
</html>
