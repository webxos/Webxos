<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="GeoDrive by WebXOS is a secure, browser-based storage solution for managing files and data. Create profiles, upload files, and track storage with a powerful console interface. Ideal for developers and secure data management.">
    <meta name="keywords" content="GeoDrive, WebXOS, secure storage, browser storage, file management, data encryption, developer tools, storage console, profile management, file upload">
    <meta name="author" content="WebXOS">
    <meta name="robots" content="index, follow">
    <meta name="title" content="GeoDrive - Secure Storage Console by WebXOS">
    <meta name="application-name" content="GeoDrive">
    <meta property="og:title" content="GeoDrive - Secure Storage Console by WebXOS">
    <meta property="og:description" content="Manage secure, encrypted file storage with GeoDrive by WebXOS. A free, browser-based tool for creating profiles, uploading files, and tracking storage usage.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.webxos.com/geodrive">
    <meta property="og:image" content="https://www.webxos.com/geodrive/preview-image.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="GeoDrive - Secure Storage Console by WebXOS">
    <meta name="twitter:description" content="GeoDrive by WebXOS provides a secure, front-end solution for encrypted file storage and management in your browser. Perfect for developers and secure data handling.">
    <meta name="twitter:image" content="https://www.webxos.com/geodrive/preview-image.jpg">
    <title>GeoDrive - Secure Storage Console</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/idb/7.1.1/umd.min.js"></script>
    <style>
        body {
            background: #000;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .logo {
            font-size: 40pt;
            color: #00ff00;
            text-align: center;
            padding: 10px 0;
            font-weight: bold;
            text-shadow: 0 0 5px #00ff00;
        }

        #console-container {
            flex: 1;
            padding: 10px;
            box-sizing: border-box;
            overflow: hidden;
        }

        #console {
            background: #000;
            height: calc(100% - 10px);
            overflow-y: auto;
            font-size: 12px;
            box-sizing: border-box;
            padding: 5px;
        }

        .bottom-section {
            padding: 10px;
            background: #000;
            width: 100%;
            box-sizing: border-box;
        }

        .input-area {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            width: 100%;
            box-sizing: border-box;
            margin-bottom: 10px;
        }

        input, button {
            background: #000;
            color: #00ff00;
            border: 1px solid #00ff00;
            font-family: 'Courier New', monospace;
            padding: 3px;
            font-size: 12px;
            flex: 1;
            min-width: 80px;
        }

        input {
            flex: 2;
        }

        button:hover {
            background: #00ff00;
            color: #000;
            cursor: pointer;
        }

        .entry {
            margin: 3px 0;
            word-wrap: break-word;
        }

        .timestamp {
            color: #008800;
            margin-right: 5px;
        }

        footer {
            text-align: center;
            font-size: 10px;
            color: #00ff00;
            padding: 5px 0;
            width: 100%;
            box-sizing: border-box;
        }

        @media (max-width: 480px) {
            .logo {
                font-size: 24pt;
                padding: 5px 0;
            }

            #console-container {
                max-height: calc(100vh - 50px - 110px);
                padding: 5px;
            }

            #console {
                font-size: 10px;
            }

            .bottom-section {
                padding: 8px 5px;
                min-height: 60px;
            }

            .input-area {
                margin-bottom: 5px;
            }

            input, button {
                font-size: 10px;
                padding: 4px;
                min-width: 70px;
            }

            footer {
                font-size: 8px;
                padding: 8px 0;
            }
        }

        @media (min-width: 481px) {
            #console-container {
                max-height: calc(100vh - 80px - 80px);
            }
        }
    </style>
</head>
<body>
    <div class="logo">GeoDrive</div>
    <div id="console-container">
        <div id="console"></div>
    </div>

    <div class="bottom-section">
        <div class="input-area">
            <input type="text" id="commandInput" placeholder="Enter command..." onkeydown="if(event.key === 'Enter') processCommand()">
            <button onclick="processCommand()">Execute</button>
            <button onclick="clearConsole()">Clear</button>
        </div>
    </div>

    <footer>
        Â© 2025 WebXOS - GeoDrive - All data stored securely in browser
    </footer>

    <script>
        // Initialize IndexedDB
        const dbPromise = idb.openDB('GeoDriveDB', 1, {
            upgrade(db) {
                db.createObjectStore('profiles', { keyPath: 'profileKey' });
                db.createObjectStore('data', { keyPath: 'dataKey' });
            }
        });

        // Browser detection for storage limits
        const ua = navigator.userAgent.toLowerCase();
        const browser = {
            chrome: /chrome|chromium|crios/.test(ua),
            firefox: /firefox|fxios/.test(ua),
            safari: /safari/.test(ua) && !/chrome|chromium|crios/.test(ua),
        };
        const MAX_PER_KEY_MB = browser.chrome || browser.firefox ? 1000 : browser.safari ? 500 : 500;
        const MAX_TOTAL_MB = 1000000; // 1TB

        let totalUsedMB = 0;
        let currentProfileKey = '';
        let deleteConfirmationPending = false;

        // Console output
        const consoleDiv = document.getElementById('console');
        function log(message) {
            const timestamp = new Date().toLocaleString();
            consoleDiv.innerHTML += `<div class="entry"><span class="timestamp">[${timestamp}]</span>${message}</div>`;
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }

        // Display help at startup
        const helpText = `
GeoDrive v1.0 - Secure Storage Console initialized
Available Commands:
PROFILE - Generate a new profile key
DRIVE - Open drive management console (requires profile key)
DELETE DRIVE - Delete current profile (requires Y/N confirmation)
UPLOAD - Upload a file to the drive
VIEW - List all uploads for the current profile
SPACE - Show storage usage and limits
DELETE [number] - Delete upload by number (e.g., DELETE 1)
DOWNLOAD [number] - Download upload by number (e.g., DOWNLOAD 1)
HELP - Show this help
Type commands below to begin
        `;
        log(helpText);

        // Create profile key
        async function createProfile() {
            try {
                const randomStr = CryptoJS.lib.WordArray.random(16).toString();
                const profileKey = `GEO_${randomStr.slice(0, 8)}-${randomStr.slice(8, 16)}-${randomStr.slice(16, 24)}`;
                const db = await dbPromise;
                await db.put('profiles', { profileKey, size: 0.001 });
                totalUsedMB += 0.001;
                currentProfileKey = profileKey;
                log(`Profile key generated: ${profileKey}`);
            } catch (err) {
                log(`ERROR: ${err.message}`);
            }
        }

        // Delete profile
        async function deleteProfile(confirmed) {
            if (!currentProfileKey) {
                log('ERROR: No profile selected.');
                return false;
            }
            if (!confirmed) {
                log('Are you sure? Type DELETE DRIVE Y to confirm, or DELETE DRIVE N to cancel.');
                deleteConfirmationPending = true;
                return false;
            }
            try {
                const db = await dbPromise;
                const profile = await db.get('profiles', currentProfileKey);
                if (!profile) {
                    log('ERROR: Invalid profile key.');
                    return false;
                }
                const dataItems = await db.getAll('data');
                const userData = dataItems.filter(d => d.profileKey === currentProfileKey);
                for (const item of userData) {
                    totalUsedMB -= item.size;
                    await db.delete('data', item.dataKey);
                }
                totalUsedMB -= 0.001;
                await db.delete('profiles', currentProfileKey);
                log(`Profile ${currentProfileKey} and all associated data deleted.`);
                currentProfileKey = '';
                deleteConfirmationPending = false;
                return true;
            } catch (err) {
                log(`ERROR: ${err.message}`);
                return false;
            }
        }

        // Upload file
        async function uploadFile(profileKey, logFn) {
            if (!profileKey) {
                logFn('ERROR: No profile selected.');
                return;
            }
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = '*/*';
            fileInput.onchange = async () => {
                const file = fileInput.files[0];
                if (!file) return;
                try {
                    const db = await dbPromise;
                    const profile = await db.get('profiles', profileKey);
                    if (!profile) {
                        logFn('ERROR: Invalid profile key.');
                        return;
                    }
                    const data = await file.arrayBuffer();
                    const sizeMB = data.byteLength / (1024 * 1024);
                    if (sizeMB > MAX_PER_KEY_MB) {
                        logFn(`ERROR: File size (${sizeMB.toFixed(3)} MB) exceeds per-key limit (${MAX_PER_KEY_MB} MB).`);
                        return;
                    }
                    if (totalUsedMB + sizeMB > MAX_TOTAL_MB) {
                        logFn(`ERROR: Not enough storage (${(MAX_TOTAL_MB - totalUsedMB).toFixed(3)} MB left).`);
                        return;
                    }
                    const aesKey = CryptoJS.SHA256(profileKey).toString();
                    const wordArray = CryptoJS.lib.WordArray.create(data);
                    const encrypted = CryptoJS.AES.encrypt(wordArray, aesKey).toString();
                    const dataHash = CryptoJS.SHA256(encrypted).toString();
                    const dataKey = `GEO_${dataHash.slice(0, 8)}-${dataHash.slice(8, 16)}-${dataHash.slice(16, 24)}`;
                    await db.put('data', {
                        dataKey,
                        profileKey,
                        fileName: file.name,
                        size: sizeMB,
                        encryptedData: encrypted,
                        isText: false
                    });
                    totalUsedMB += sizeMB;
                    logFn(`File "${file.name}" uploaded. Key: ${dataKey}`);
                } catch (err) {
                    logFn(`ERROR: ${err.message}`);
                }
            };
            fileInput.click();
        }

        // View uploads
        async function viewUploads(profileKey, logFn) {
            if (!profileKey) {
                logFn('ERROR: No profile selected.');
                return;
            }
            try {
                const db = await dbPromise;
                const profile = await db.get('profiles', profileKey);
                if (!profile) {
                    logFn('ERROR: Invalid profile key.');
                    return;
                }
                const dataItems = await db.getAll('data');
                const userData = dataItems.filter(d => d.profileKey === profileKey);
                if (userData.length === 0) {
                    logFn('No uploads found.');
                    return;
                }
                logFn('Uploads:');
                userData.forEach((item, index) => {
                    logFn(`[${index + 1}] ${item.fileName} (${item.size.toFixed(3)} MB) Key: ${item.dataKey}`);
                });
            } catch (err) {
                logFn(`ERROR: ${err.message}`);
            }
        }

        // Storage info
        async function storageInfo(profileKey, logFn) {
            if (!profileKey) {
                logFn('ERROR: No profile selected.');
                return;
            }
            try {
                const db = await dbPromise;
                const profile = await db.get('profiles', profileKey);
                if (!profile) {
                    logFn('ERROR: Invalid profile key.');
                    return;
                }
                const dataItems = await db.getAll('data');
                const userData = dataItems.filter(d => d.profileKey === profileKey);
                totalUsedMB = 0.001;
                userData.forEach(d => totalUsedMB += d.size || 0);
                logFn(`Storage Info:
Browser: ${browser.chrome ? 'Chrome' : browser.firefox ? 'Firefox' : browser.safari ? 'Safari' : 'Unknown'}
Max per key: ${MAX_PER_KEY_MB} MB
Total used: ${totalUsedMB.toFixed(3)} MB
Remaining: ${(MAX_TOTAL_MB - totalUsedMB).toFixed(3)} MB of ${MAX_TOTAL_MB} MB`);
            } catch (err) {
                logFn(`ERROR: ${err.message}`);
            }
        }

        // Delete upload by number
        async function deleteUpload(profileKey, number, logFn) {
            if (!profileKey) {
                logFn('ERROR: No profile selected.');
                return;
            }
            try {
                const db = await dbPromise;
                const profile = await db.get('profiles', profileKey);
                if (!profile) {
                    logFn('ERROR: Invalid profile key.');
                    return;
                }
                const dataItems = await db.getAll('data');
                const userData = dataItems.filter(d => d.profileKey === profileKey);
                const index = parseInt(number) - 1;
                if (isNaN(index) || index < 0 || index >= userData.length) {
                    logFn(`ERROR: Invalid upload number. Use VIEW to see upload numbers.`);
                    return;
                }
                const item = userData[index];
                totalUsedMB -= item.size;
                await db.delete('data', item.dataKey);
                logFn(`Upload "${item.fileName}" deleted.`);
            } catch (err) {
                logFn(`ERROR: ${err.message}`);
            }
        }

        // Download upload by number
        async function downloadUpload(profileKey, number, logFn) {
            if (!profileKey) {
                logFn('ERROR: No profile selected.');
                return;
            }
            try {
                const db = await dbPromise;
                const profile = await db.get('profiles', profileKey);
                if (!profile) {
                    logFn('ERROR: Invalid profile key.');
                    return;
                }
                const dataItems = await db.getAll('data');
                const userData = dataItems.filter(d => d.profileKey === profileKey);
                const index = parseInt(number) - 1;
                if (isNaN(index) || index < 0 || index >= userData.length) {
                    logFn(`ERROR: Invalid upload number. Use VIEW to see upload numbers.`);
                    return;
                }
                const data = userData[index];
                const aesKey = CryptoJS.SHA256(profileKey).toString();
                const decrypted = CryptoJS.AES.decrypt(data.encryptedData, aesKey);
                const blob = new Blob([decrypted.toString(CryptoJS.enc.Latin1)], { type: 'application/octet-stream' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = data.fileName;
                a.click();
                URL.revokeObjectURL(url);
                logFn(`File "${data.fileName}" downloaded.`);
            } catch (err) {
                logFn(`ERROR: ${err.message}`);
            }
        }

        // Drive popup console
        async function openDrive() {
            const profileKey = prompt('Enter your profile key:');
            if (!profileKey) {
                log('ERROR: Profile key required.');
                return;
            }
            try {
                const db = await dbPromise;
                const profile = await db.get('profiles', profileKey);
                if (!profile) {
                    log('ERROR: Invalid profile key.');
                    return;
                }
                currentProfileKey = profileKey;
                const dataItems = await db.getAll('data');
                const userData = dataItems.filter(d => d.profileKey === profileKey);
                totalUsedMB = 0.001;
                userData.forEach(d => totalUsedMB += d.size || 0);

                const popup = window.open('', 'GeoDrive', 'width=600,height=400');
                popup.document.write(`
                    <!DOCTYPE html>
                    <html lang="en">
                    <head>
                        <meta charset="UTF-8">
                        <meta name="viewport" content="width=device-width, initial-scale=1.0">
                        <title>GeoDrive - Drive Console</title>
                        <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
                        <script src="https://cdnjs.cloudflare.com/ajax/libs/idb/7.1.1/umd.min.js"></script>
                        <style>
                            body {
                                background: #000;
                                color: #00ff00;
                                font-family: 'Courier New', monospace;
                                margin: 0;
                                padding: 0;
                                height: 100vh;
                                display: flex;
                                flex-direction: column;
                                overflow: hidden;
                            }
                            .logo {
                                font-size: 24pt;
                                color: #00ff00;
                                text-align: center;
                                padding: 10px 0;
                                font-weight: bold;
                                text-shadow: 0 0 5px #00ff00;
                            }
                            #console-container {
                                flex: 1;
                                padding: 10px;
                                box-sizing: border-box;
                                overflow: hidden;
                            }
                            #console {
                                background: #000;
                                height: calc(100% - 10px);
                                overflow-y: auto;
                                font-size: 12px;
                                box-sizing: border-box;
                                padding: 5px;
                            }
                            .bottom-section {
                                padding: 10px;
                                background: #000;
                                width: 100%;
                                box-sizing: border-box;
                            }
                            .input-area {
                                display: flex;
                                flex-wrap: wrap;
                                gap: 5px;
                                width: 100%;
                                box-sizing: border-box;
                                margin-bottom: 10px;
                            }
                            input, button {
                                background: #000;
                                color: #00ff00;
                                border: 1px solid #00ff00;
                                font-family: 'Courier New', monospace;
                                padding: 3px;
                                font-size: 12px;
                                flex: 1;
                                min-width: 80px;
                            }
                            input {
                                flex: 2;
                            }
                            button:hover {
                                background: #00ff00;
                                color: #000;
                                cursor: pointer;
                            }
                            .entry {
                                margin: 3px 0;
                                word-wrap: break-word;
                            }
                            .timestamp {
                                color: #008800;
                                margin-right: 5px;
                            }
                            @media (max-width: 480px) {
                                .logo {
                                    font-size: 18pt;
                                    padding: 5px 0;
                                }
                                #console-container {
                                    max-height: calc(100vh - 40px - 80px);
                                    padding: 5px;
                                }
                                #console {
                                    font-size: 10px;
                                }
                                .bottom-section {
                                    padding: 8px 5px;
                                    min-height: 60px;
                                }
                                .input-area {
                                    margin-bottom: 5px;
                                }
                                input, button {
                                    font-size: 10px;
                                    padding: 4px;
                                    min-width: 70px;
                                }
                            }
                        </style>
                    </head>
                    <body>
                        <div class="logo">GeoDrive Drive</div>
                        <div id="console-container">
                            <div id="console"></div>
                        </div>
                        <div class="bottom-section">
                            <div class="input-area">
                                <input type="text" id="commandInput" placeholder="Enter command..." onkeydown="if(event.key === 'Enter') processDriveCommand()">
                                <button onclick="processDriveCommand()">Execute</button>
                                <button onclick="clearDriveConsole()">Clear</button>
                            </div>
                        </div>
                        <script>
                            const dbPromise = idb.openDB('GeoDriveDB', 1);
                            let totalUsedMB = ${totalUsedMB};
                            const profileKey = '${profileKey}';

                            const consoleDiv = document.getElementById('console');
                            function log(message) {
                                const timestamp = new Date().toLocaleString();
                                consoleDiv.innerHTML += \`<div class="entry"><span class="timestamp">[\${timestamp}]</span>\${message}</div>\`;
                                consoleDiv.scrollTop = consoleDiv.scrollHeight;
                            }

                            const helpText = \`
GeoDrive Drive Console - Profile: ${profileKey}
Available Commands:
UPLOAD - Upload a file
VIEW - List all uploads
SPACE - Show storage usage and limits
DELETE [number] - Delete upload by number (e.g., DELETE 1)
DOWNLOAD [number] - Download upload by number (e.g., DOWNLOAD 1)
HELP - Show this help
Type commands below to begin
                            \`;
                            log(helpText);

                            ${uploadFile.toString()}
                            ${viewUploads.toString()}
                            ${storageInfo.toString()}
                            ${deleteUpload.toString()}
                            ${downloadUpload.toString()}

                            async function processDriveCommand() {
                                const input = document.getElementById('commandInput').value.trim().toUpperCase();
                                if (!input) return;
                                document.getElementById('commandInput').value = '';
                                const [cmd, arg] = input.split(' ', 2);
                                switch (cmd) {
                                    case 'UPLOAD':
                                        await uploadFile(profileKey, log);
                                        break;
                                    case 'VIEW':
                                        await viewUploads(profileKey, log);
                                        break;
                                    case 'SPACE':
                                        await storageInfo(profileKey, log);
                                        break;
                                    case 'DELETE':
                                        if (arg && !isNaN(arg)) {
                                            await deleteUpload(profileKey, arg, log);
                                        } else {
                                            log('ERROR: Use DELETE [number].');
                                        }
                                        break;
                                    case 'DOWNLOAD':
                                        if (arg && !isNaN(arg)) {
                                            await downloadUpload(profileKey, arg, log);
                                        } else {
                                            log('ERROR: Use DOWNLOAD [number].');
                                        }
                                        break;
                                    case 'HELP':
                                        log(helpText);
                                        break;
                                    default:
                                        log('ERROR: Unknown command. Type HELP for commands.');
                                }
                            }

                            function clearDriveConsole() {
                                consoleDiv.innerHTML = '';
                                log(helpText);
                            }
                        </script>
                    </body>
                    </html>
    </script>
</body>
</html>
